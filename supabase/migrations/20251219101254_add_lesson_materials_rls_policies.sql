CREATE POLICY "Teachers can insert lesson materials" ON lesson_materials FOR INSERT TO authenticated WITH CHECK (EXISTS (SELECT 1 FROM lessons WHERE lessons.id = lesson_materials.lesson_id AND lessons.teacher_id = auth.uid())); CREATE POLICY "Teachers can update lesson materials" ON lesson_materials FOR UPDATE TO authenticated USING (EXISTS (SELECT 1 FROM lessons WHERE lessons.id = lesson_materials.lesson_id AND lessons.teacher_id = auth.uid())); CREATE POLICY "Teachers can delete lesson materials" ON lesson_materials FOR DELETE TO authenticated USING (EXISTS (SELECT 1 FROM lessons WHERE lessons.id = lesson_materials.lesson_id AND lessons.teacher_id = auth.uid()));;
